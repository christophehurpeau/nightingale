{"version":3,"file":"index-node18.mjs","sources":["../src/index.ts"],"sourcesContent":["/* eslint-disable camelcase */\nimport levelNames from 'nightingale-level-names';\nimport type {\n  LogRecord,\n  Level,\n  Handle,\n  Metadata,\n  Handler,\n} from 'nightingale-types';\n\nexport type LogCallback = (err: Error | null) => void;\n\nexport interface WinstonTransportType {\n  log: (\n    level: number,\n    message: string,\n    metadata: Record<string, unknown>,\n    callback: LogCallback,\n  ) => void;\n}\n\nexport class WinstonAdapterHandler implements Handler {\n  minLevel: Level;\n\n  handle: Handle;\n\n  constructor(winstonTransport: WinstonTransportType, minLevel: Level) {\n    this.minLevel = minLevel;\n    this.handle = <T extends Metadata>(record: LogRecord<T>) => {\n      // new Promise((resolve, reject) => {\n      winstonTransport.log(\n        record.level,\n        record.message,\n        {\n          level_name: levelNames.get(record.level),\n          key: record.key,\n          metadata: record.metadata,\n          extra: record.extra,\n          context: record.context,\n        },\n        (err) => {\n          if (err) {\n            // eslint-disable-next-line no-console\n            console.warn(err);\n            // return reject(err);\n          }\n\n          // resolve();\n        },\n      );\n      // });\n    };\n  }\n}\n"],"names":["WinstonAdapterHandler","constructor","winstonTransport","minLevel","handle","record","log","level","message","level_name","levelNames","get","key","metadata","extra","context","err","console","warn"],"mappings":";;AAAA;AAqBO,MAAMA,qBAAqB,CAAoB;AAKpDC,EAAAA,WAAWA,CAACC,gBAAsC,EAAEC,QAAe,EAAE;IACnE,IAAI,CAACA,QAAQ,GAAGA,QAAQ,CAAA;AACxB,IAAA,IAAI,CAACC,MAAM,GAAwBC,MAAoB,IAAK;AAC1D;MACAH,gBAAgB,CAACI,GAAG,CAClBD,MAAM,CAACE,KAAK,EACZF,MAAM,CAACG,OAAO,EACd;QACEC,UAAU,EAAEC,UAAU,CAACC,GAAG,CAACN,MAAM,CAACE,KAAK,CAAC;QACxCK,GAAG,EAAEP,MAAM,CAACO,GAAG;QACfC,QAAQ,EAAER,MAAM,CAACQ,QAAQ;QACzBC,KAAK,EAAET,MAAM,CAACS,KAAK;QACnBC,OAAO,EAAEV,MAAM,CAACU,OAAAA;OACjB,EACAC,GAAG,IAAK;AACP,QAAA,IAAIA,GAAG,EAAE;AACP;AACAC,UAAAA,OAAO,CAACC,IAAI,CAACF,GAAG,CAAC,CAAA;AACjB;AACF,SAAA;;AAEA;AACF,OACF,CAAC,CAAA;AACD;KACD,CAAA;AACH,GAAA;AACF;;;;"}