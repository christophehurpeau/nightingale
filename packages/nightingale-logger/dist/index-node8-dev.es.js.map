{"version":3,"file":"index-node8-dev.es.js","sources":["../src/index.ts"],"sourcesContent":["/* eslint-disable max-lines */\n\nimport * as util from 'util';\nimport Level from 'nightingale-levels';\nimport { Metadata, MetadataStyles, Styles, Handler, Processor, Record } from 'nightingale-types';\n\ndeclare const global: any;\n\nexport { Level };\n\nexport interface Options<T> {\n  symbol?: string;\n  metadataStyles?: MetadataStyles<T>;\n  styles?: Styles;\n}\n\nexport interface ComputedConfigForKey {\n  handlers: Handler[];\n  processors: Processor[];\n}\n\ninterface ExtendedErrorMetadata {\n  error: Error;\n}\n\ninterface ExtendedTimeMetadata {\n  readableTime: string;\n  timeMs: number;\n}\n\ninterface ExtendedFunctionNameMetadata {\n  functionName: string;\n}\n\nif (!global.__NIGHTINGALE_GET_CONFIG_FOR_LOGGER) {\n  global.__NIGHTINGALE_GET_CONFIG_FOR_LOGGER = (): ComputedConfigForKey => ({\n    handlers: [],\n    processors: [],\n  });\n}\n\nif (global.__NIGHTINGALE_GET_CONFIG_FOR_LOGGER_RECORD) {\n  global.__NIGHTINGALE_GET_CONFIG_FOR_LOGGER_RECORD = (\n    key: string,\n    level: number,\n  ): ComputedConfigForKey => {\n    const {\n      handlers,\n      processors,\n    }: ComputedConfigForKey = global.__NIGHTINGALE_GET_CONFIG_FOR_LOGGER(key);\n\n    return {\n      handlers: handlers.filter(\n        handler =>\n          level >= handler.minLevel && (!handler.isHandling || handler.isHandling(level, key)),\n      ),\n      processors,\n    };\n  };\n}\n\n/** @private */\nfunction getConfigForLoggerRecord(key: string, recordLevel: number): ComputedConfigForKey {\n  return global.__NIGHTINGALE_GET_CONFIG_FOR_LOGGER_RECORD(key, recordLevel);\n}\n\n/**\n * Interface that allows you to log records.\n * This records are treated by handlers\n */\nexport default class Logger {\n  private contextObject?: Object;\n\n  /**\n   * Create a new Logger\n   *\n   * @param {string} key\n   * @param {string} [displayName]\n   */\n  constructor(readonly key: string, readonly displayName?: string) {\n    this.key = key;\n    this.displayName = displayName;\n\n    if (process.env.NODE_ENV !== 'production' && key.includes('.')) {\n      throw new Error(`nightingale: \\`.\\` in key is no longer supported (key: ${key})`);\n    }\n  }\n\n  /** @private */\n  getHandlersAndProcessors(recordLevel: number): ComputedConfigForKey {\n    return getConfigForLoggerRecord(this.key, recordLevel);\n  }\n\n  /** @private */\n  getConfig(): ComputedConfigForKey {\n    return global.__NIGHTINGALE_GET_CONFIG_FOR_LOGGER(this.key, Level.ALL);\n  }\n\n  /**\n   * Create a child logger\n   */\n  child(childSuffixKey: string, childDisplayName?: string): Logger {\n    return new Logger(`${this.key}:${childSuffixKey}`, childDisplayName);\n  }\n\n  /**\n   * Create a new Logger with the same key a this attached context\n   *\n   * @example\n   * const loggerMyService = new Logger('app.myService');\n   * function someAction(arg1) {\n   *     const logger = loggerMyService.context({ arg1 });\n   *     logger.info('starting');\n   *     // do stuff\n   *     logger.info('done');\n   * }\n   *\n   */\n  context(context: Object): Logger {\n    const logger = new Logger(this.key);\n    logger.setContext(context);\n    return logger;\n  }\n\n  /**\n   * Set the context of this logger\n   *\n   * @param {Object} context\n   */\n  setContext(context: Object) {\n    this.contextObject = context;\n  }\n\n  /**\n   * Extends existing context of this logger\n   */\n  extendsContext(extendedContext: Object) {\n    Object.assign(this.contextObject, extendedContext);\n  }\n\n  /**\n   * Handle a record\n   *\n   * Use this only if you know what you are doing.\n   */\n  addRecord<T extends Metadata>(record: Readonly<Record<T>>) {\n    const { handlers, processors } = this.getHandlersAndProcessors(record.level);\n\n    if (handlers.length === 0) {\n      if (record.level > Level.ERROR) {\n        // eslint-disable-next-line no-console\n        console.log('[nightingale] no logger for > error level.', {\n          key: record.key,\n          message: record.message,\n        });\n      }\n      return;\n    }\n\n    if (processors) {\n      processors.forEach(process => process(record, record.context));\n    }\n\n    handlers.some(handler => handler.handle(record) === false);\n  }\n\n  /**\n   * Log a message\n   */\n  log<T extends Metadata>(\n    message: string,\n    metadata?: T,\n    level: number = Level.INFO,\n    options?: Options<T>,\n  ) {\n    const context = metadata && metadata.context;\n    if (metadata) {\n      delete metadata.context;\n    }\n\n    const record: Record<T> = {\n      level,\n      key: this.key,\n      displayName: this.displayName,\n      datetime: new Date(),\n      message,\n      context: context || this.contextObject,\n      metadata,\n      extra: {},\n      ...options,\n    };\n    this.addRecord(record);\n  }\n\n  /**\n   * Log a trace message\n   */\n  trace<T extends Metadata>(message: string, metadata?: T, metadataStyles?: MetadataStyles<T>) {\n    this.log(message, metadata, Level.TRACE, { metadataStyles });\n  }\n\n  /**\n   * Log a debug message\n   */\n  debug<T extends Metadata>(message: string, metadata?: T, metadataStyles?: MetadataStyles<T>) {\n    this.log(message, metadata, Level.DEBUG, { metadataStyles });\n  }\n\n  /**\n   * Notice an info message\n   */\n  notice<T extends Metadata>(message: string, metadata?: T, metadataStyles?: MetadataStyles<T>) {\n    this.log(message, metadata, Level.NOTICE, { metadataStyles });\n  }\n\n  /**\n   * Log an info message\n   */\n  info<T extends Metadata>(message: string, metadata?: T, metadataStyles?: MetadataStyles<T>) {\n    this.log(message, metadata, Level.INFO, { metadataStyles });\n  }\n\n  /**\n   * Log a warn message\n   */\n  warn<T extends Metadata>(message: string, metadata?: T, metadataStyles?: MetadataStyles<T>) {\n    this.log(message, metadata, Level.WARN, { metadataStyles });\n  }\n\n  /**\n   * Log an error message\n   */\n  error<T extends Metadata>(\n    message: string | Error,\n    metadata?: T,\n    metadataStyles?: MetadataStyles<T>,\n  ) {\n    if (message instanceof Error) {\n      const extendedMetadata: T & ExtendedErrorMetadata = Object.assign({}, metadata, {\n        error: message,\n      });\n      message = `${extendedMetadata.error.name}: ${extendedMetadata.error.message}`;\n      this.log(message, extendedMetadata, Level.ERROR, { metadataStyles });\n    } else {\n      this.log(message, metadata, Level.ERROR, { metadataStyles });\n    }\n  }\n\n  /**\n   * Log an critical message\n   */\n  critical<T extends Metadata>(message: string, metadata?: T, metadataStyles?: MetadataStyles<T>) {\n    this.log(message, metadata, Level.CRITICAL, { metadataStyles });\n  }\n\n  /**\n   * Log a fatal message\n   */\n  fatal<T extends Metadata>(message: string, metadata?: T, metadataStyles?: MetadataStyles<T>) {\n    this.log(message, metadata, Level.FATAL, { metadataStyles });\n  }\n\n  /**\n   * Log an alert message\n   */\n  alert<T extends Metadata>(message: string, metadata?: T, metadataStyles?: MetadataStyles<T>) {\n    this.log(message, metadata, Level.ALERT, { metadataStyles });\n  }\n\n  /**\n   * Log an inspected value\n   */\n  inspectValue<T extends Metadata>(value: any, metadata?: T, metadataStyles?: MetadataStyles<T>) {\n    if (process.env.POB_TARGET === 'browser') {\n      throw new Error('Not supported for the browser. Prefer `debugger;`');\n    } else {\n      // Note: inspect is a special function for node:\n      // https://github.com/nodejs/node/blob/a1bda1b4deb08dfb3e06cb778f0db40023b18318/lib/util.js#L210\n      value = util.inspect(value, { depth: 6 });\n      this.log(value, metadata, Level.DEBUG, { metadataStyles, styles: ['gray'] });\n    }\n  }\n\n  /**\n   * Log a debugged var\n   */\n  inspectVar<T extends Metadata>(\n    varName: string,\n    varValue: any,\n    metadata?: T,\n    metadataStyles?: MetadataStyles<T>,\n  ) {\n    if (process.env.POB_TARGET === 'browser') {\n      throw new Error('Not supported for the browser. Prefer `debugger;`');\n    } else {\n      varValue = util.inspect(varValue, { depth: 6 });\n      this.log(`${varName} = ${varValue}`, metadata, Level.DEBUG, {\n        metadataStyles,\n        styles: ['cyan'],\n      });\n    }\n  }\n\n  /**\n   * Alias for infoSuccess\n   */\n  success<T extends Metadata>(message: string, metadata?: T, metadataStyles?: MetadataStyles<T>) {\n    this.infoSuccess(message, metadata, metadataStyles);\n  }\n\n  /**\n   * Log an info success message\n   */\n  infoSuccess<T extends Metadata>(\n    message: string,\n    metadata?: T,\n    metadataStyles?: MetadataStyles<T>,\n  ) {\n    this.log(message, metadata, Level.INFO, {\n      metadataStyles,\n      symbol: '✔',\n      styles: ['green', 'bold'],\n    });\n  }\n\n  /**\n   * Log an debug success message\n   */\n  debugSuccess<T extends Metadata>(\n    message: string,\n    metadata?: T,\n    metadataStyles?: MetadataStyles<T>,\n  ) {\n    this.log(message, metadata, Level.DEBUG, {\n      metadataStyles,\n      symbol: '✔',\n      styles: ['green'],\n    });\n  }\n\n  /**\n   * Alias for infoFail\n   */\n  fail<T extends Metadata>(message: string, metadata?: T, metadataStyles?: MetadataStyles<T>) {\n    this.infoFail(message, metadata, metadataStyles);\n  }\n\n  /**\n   * Log an info fail message\n   */\n  infoFail<T extends Metadata>(message: string, metadata?: T, metadataStyles?: MetadataStyles<T>) {\n    this.log(message, metadata, Level.INFO, {\n      metadataStyles,\n      symbol: '✖',\n      styles: ['red', 'bold'],\n    });\n  }\n\n  /**\n   * Log an debug fail message\n   */\n  debugFail<T extends Metadata>(message: string, metadata?: T, metadataStyles?: MetadataStyles<T>) {\n    this.log(message, metadata, Level.DEBUG, {\n      metadataStyles,\n      symbol: '✖',\n      styles: ['red'],\n    });\n  }\n\n  /**\n   * @returns {number} time to pass to timeEnd\n   */\n  time<T extends Metadata>(\n    message?: string,\n    metadata?: T,\n    metadataStyles?: MetadataStyles<T>,\n    level: number = Level.DEBUG,\n  ): number {\n    if (message) {\n      this.log(message, metadata, level, { metadataStyles });\n    }\n\n    return Date.now();\n  }\n\n  infoTime<T extends Metadata>(\n    message?: string,\n    metadata?: T,\n    metadataStyles?: MetadataStyles<T>,\n  ): number {\n    return this.time(message, metadata, metadataStyles, Level.INFO);\n  }\n\n  /**\n   * Finds difference between when this method\n   * was called and when the respective time method\n   * was called, then logs out the difference\n   * and deletes the original record\n   */\n  timeEnd<T extends Metadata>(\n    startTime: number,\n    message: string,\n    metadata?: T,\n    metadataStyles?: MetadataStyles<T>,\n    level: number = Level.DEBUG,\n    options?: Options<T>,\n  ) {\n    const now = Date.now();\n\n    const diffTime = now - startTime;\n    let readableTime;\n\n    if (diffTime < 1000) {\n      readableTime = `${diffTime}ms`;\n    } else {\n      const seconds = diffTime > 1000 ? Math.floor(diffTime / 1000) : 0;\n      const ms = diffTime - seconds * 1000;\n      readableTime = `${seconds ? `${seconds}s and ` : ''}${ms}ms`;\n    }\n\n    const extendedMetadata: T & ExtendedTimeMetadata = Object.assign({}, metadata, {\n      readableTime,\n      timeMs: diffTime,\n    });\n\n    this.log(message, extendedMetadata, level, { ...options, metadataStyles });\n  }\n\n  /**\n   * Like timeEnd, but with INFO level\n   */\n  infoTimeEnd<T extends Metadata>(\n    time: number,\n    message: string,\n    metadata?: T,\n    metadataStyles?: MetadataStyles<T>,\n  ) {\n    this.timeEnd(time, message, metadata, metadataStyles, Level.INFO);\n  }\n\n  /**\n   * Like timeEnd, but with INFO level\n   */\n  infoSuccessTimeEnd<T extends Metadata>(\n    time: number,\n    message: string,\n    metadata?: T,\n    metadataStyles?: MetadataStyles<T>,\n  ) {\n    this.timeEnd(time, message, metadata, metadataStyles, Level.INFO, {\n      symbol: '✔',\n      styles: ['green', 'bold'],\n    });\n  }\n\n  /**\n   * Log an enter in a function\n   *\n   * @example\n   * class A {\n   *   method(arg1) {\n   *     logger.enter(method, { arg1 });\n   *     // Do your stuff\n   *   }\n   * }\n   *\n   */\n  enter<T extends Metadata>(fn: Function, metadata?: T, metadataStyles?: MetadataStyles<T>) {\n    const extendedMetadata: Metadata = metadata || {};\n    extendedMetadata.functionName = fn.name;\n    this.log('enter', metadata, Level.TRACE, { metadataStyles });\n  }\n\n  /**\n   * Log an exit in a function\n   *\n   * @example\n   * const logger = new ConsoleLogger('myNamespace.A');\n   * class A {\n   *   method(arg1) {\n   *     // Do your stuff\n   *     logger.exit(method, { arg1 });\n   *   }\n   * }\n   */\n  exit<T extends Metadata>(\n    fn: Function,\n    metadata?: T,\n    metadataStyles?: MetadataStyles<T & { functionName: string }>,\n  ) {\n    const extendedMetadata: T & ExtendedFunctionNameMetadata = Object.assign({}, metadata, {\n      functionName: fn.name,\n    });\n    this.log('exit', extendedMetadata, Level.TRACE, { metadataStyles });\n  }\n\n  /**\n   * Wrap around a function to log enter and exit of a function\n   *\n   * @example\n   * const logger = new ConsoleLogger('myNamespace.A');\n   * class A {\n   *   method() {\n   *     logger.wrap(method, () => {\n   *       // Do your stuff\n   *     });\n   *   }\n   * }\n   *\n   * @param {Function} fn\n   * @param {Object} [metadata]\n   * @param {Object} [metadataStyles]\n   * @param {Function} callback\n   */\n  wrap<T extends Metadata>(\n    fn: Function,\n    metadata?: T | Function,\n    metadataStyles?: MetadataStyles<T> | Function,\n    callback?: Function,\n  ) {\n    if (typeof metadata === 'function') {\n      callback = metadata;\n      metadata = undefined;\n    } else if (typeof metadataStyles === 'function') {\n      callback = metadataStyles;\n      metadataStyles = undefined;\n    }\n\n    this.enter(fn, metadata, metadataStyles as MetadataStyles<T>);\n    (callback as Function)();\n    this.exit(fn);\n  }\n}\n"],"names":["global","__NIGHTINGALE_GET_CONFIG_FOR_LOGGER","__NIGHTINGALE_GET_CONFIG_FOR_LOGGER_RECORD","key","level","handlers","filter","handler","minLevel","isHandling","getConfigForLoggerRecord","recordLevel","Logger","displayName","contextObject","process","env","NODE_ENV","includes","Error","Level","ALL","childSuffixKey","childDisplayName","context","logger","setContext","extendedContext","assign","record","getHandlersAndProcessors","length","ERROR","log","message","processors","forEach","some","handle","metadata","INFO","options","Date","addRecord","metadataStyles","TRACE","DEBUG","NOTICE","WARN","extendedMetadata","Object","error","name","CRITICAL","FATAL","ALERT","value","POB_TARGET","util","varName","varValue","infoSuccess","infoFail","now","time","startTime","diffTime","readableTime","seconds","Math","floor","timeEnd","fn","functionName","callback","undefined","enter","exit"],"mappings":"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"}