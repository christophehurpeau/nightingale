{"version":3,"file":"index-node18.mjs","sources":["../src/index.ts"],"sourcesContent":["import type { IncomingMessage } from \"node:http\";\nimport type { LogRecord, Metadata } from \"nightingale-types\";\n\nexport interface ContextWithOptionalRequest {\n  request?: IncomingMessage;\n}\n\nexport default function webProcessor<T extends Metadata>(\n  record: LogRecord<T>,\n  context?: ContextWithOptionalRequest,\n): void {\n  const request = context?.request;\n  if (request) {\n    record.extra = record.extra || {};\n    Object.assign(record.extra, {\n      url: request.url,\n      method: request.method,\n      server: request.headers.host,\n      ip:\n        request.headers[\"x-forwarded-for\"] || request.connection.remoteAddress,\n    });\n  }\n}\n"],"names":["webProcessor","record","context","request","extra","Object","assign","url","method","server","headers","host","ip","connection","remoteAddress"],"mappings":"AAOe,SAASA,YAAYA,CAClCC,MAAoB,EACpBC,OAAoC,EAC9B;AACN,EAAA,MAAMC,OAAO,GAAGD,OAAO,EAAEC,OAAO,CAAA;AAChC,EAAA,IAAIA,OAAO,EAAE;IACXF,MAAM,CAACG,KAAK,GAAGH,MAAM,CAACG,KAAK,IAAI,EAAE,CAAA;AACjCC,IAAAA,MAAM,CAACC,MAAM,CAACL,MAAM,CAACG,KAAK,EAAE;MAC1BG,GAAG,EAAEJ,OAAO,CAACI,GAAG;MAChBC,MAAM,EAAEL,OAAO,CAACK,MAAM;AACtBC,MAAAA,MAAM,EAAEN,OAAO,CAACO,OAAO,CAACC,IAAI;MAC5BC,EAAE,EACAT,OAAO,CAACO,OAAO,CAAC,iBAAiB,CAAC,IAAIP,OAAO,CAACU,UAAU,CAACC,aAAAA;AAC7D,KAAC,CAAC,CAAA;AACJ,GAAA;AACF;;;;"}