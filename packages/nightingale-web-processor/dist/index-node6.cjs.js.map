{"version":3,"file":"index-node6.cjs.js","sources":["../src/index.ts"],"sourcesContent":["import { IncomingMessage } from 'http';\nimport { Record } from 'nightingale-types';\n\nexport interface ContextWithOptionalRequest {\n  request?: IncomingMessage;\n}\n\nexport default function webProcessor<T>(record: Record<T>, context?: ContextWithOptionalRequest) {\n  const request = context && context.request;\n  if (request) {\n    record.extra = record.extra || {};\n    record.extra.url = request.url;\n    record.extra.method = request.method;\n    record.extra.server = request.headers.host;\n    record.extra.ip = request.headers['x-forwarded-for'] || request.connection.remoteAddress;\n  }\n}\n"],"names":["webProcessor","record","context","request","extra","url","method","server","headers","host","ip","connection","remoteAddress"],"mappings":";;;;AAOe,SAASA,YAAT,CAAyBC,MAAzB,EAA4CC,OAA5C,EAAkF;QACzFC,UAAUD,WAAWA,QAAQC,OAAnC;;MACIA,OAAJ,EAAa;WACJC,KAAP,GAAeH,OAAOG,KAAP,IAAgB,EAA/B;WACOA,KAAP,CAAaC,GAAb,GAAmBF,QAAQE,GAA3B;WACOD,KAAP,CAAaE,MAAb,GAAsBH,QAAQG,MAA9B;WACOF,KAAP,CAAaG,MAAb,GAAsBJ,QAAQK,OAAR,CAAgBC,IAAtC;WACOL,KAAP,CAAaM,EAAb,GAAkBP,QAAQK,OAAR,CAAgB,iBAAhB,KAAsCL,QAAQQ,UAAR,CAAmBC,aAA3E;;;;;;"}