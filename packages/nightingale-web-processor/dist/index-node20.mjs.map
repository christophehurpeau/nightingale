{"version":3,"file":"index-node20.mjs","sources":["../src/index.ts"],"sourcesContent":["import type { IncomingMessage } from \"node:http\";\nimport type { LogRecord, Metadata } from \"nightingale-types\";\n\nexport interface ContextWithOptionalRequest {\n  request?: IncomingMessage;\n}\n\nexport default function webProcessor<T extends Metadata>(\n  record: LogRecord<T>,\n  context?: ContextWithOptionalRequest,\n): void {\n  const request = context?.request;\n  if (request) {\n    record.extra = record.extra || {};\n    Object.assign(record.extra, {\n      url: request.url,\n      method: request.method,\n      server: request.headers.host,\n      ip: request.headers[\"x-forwarded-for\"] || request.socket.remoteAddress,\n    });\n  }\n}\n"],"names":[],"mappings":"AAOA,SAAwB,YAAA,CACtB,QACA,OAAA,EACM;AACN,EAAA,MAAM,UAAU,OAAA,EAAS,OAAA;AACzB,EAAA,IAAI,OAAA,EAAS;AACX,IAAA,MAAA,CAAO,KAAA,GAAQ,MAAA,CAAO,KAAA,IAAS,EAAC;AAChC,IAAA,MAAA,CAAO,MAAA,CAAO,OAAO,KAAA,EAAO;AAAA,MAC1B,KAAK,OAAA,CAAQ,GAAA;AAAA,MACb,QAAQ,OAAA,CAAQ,MAAA;AAAA,MAChB,MAAA,EAAQ,QAAQ,OAAA,CAAQ,IAAA;AAAA,MACxB,IAAI,OAAA,CAAQ,OAAA,CAAQ,iBAAiB,CAAA,IAAK,QAAQ,MAAA,CAAO;AAAA,KAC1D,CAAA;AAAA;AAEL;;;;"}