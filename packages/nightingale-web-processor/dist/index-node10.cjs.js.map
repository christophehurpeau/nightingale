{"version":3,"file":"index-node10.cjs.js","sources":["../src/index.ts"],"sourcesContent":["import { IncomingMessage } from 'http';\nimport { LogRecord } from 'nightingale-types';\n\nexport interface ContextWithOptionalRequest {\n  request?: IncomingMessage;\n}\n\nexport default function webProcessor<T>(\n  record: LogRecord<T>,\n  context?: ContextWithOptionalRequest,\n) {\n  const request = context?.request;\n  if (request) {\n    record.extra = record.extra || {};\n    record.extra.url = request.url;\n    record.extra.method = request.method;\n    record.extra.server = request.headers.host;\n    record.extra.ip =\n      request.headers['x-forwarded-for'] || request.connection.remoteAddress;\n  }\n}\n"],"names":["webProcessor","record","context","request","extra","url","method","server","headers","host","ip","connection","remoteAddress"],"mappings":";;;;AAOe,SAASA,YAAT,CACbC,MADa,EAEbC,OAFa,EAGb;AACA,QAAMC,OAAO,GAAGD,OAAH,aAAGA,OAAH,uBAAGA,OAAO,CAAEC,OAAzB;;AACA,MAAIA,OAAJ,EAAa;AACXF,IAAAA,MAAM,CAACG,KAAP,GAAeH,MAAM,CAACG,KAAP,IAAgB,EAA/B;AACAH,IAAAA,MAAM,CAACG,KAAP,CAAaC,GAAb,GAAmBF,OAAO,CAACE,GAA3B;AACAJ,IAAAA,MAAM,CAACG,KAAP,CAAaE,MAAb,GAAsBH,OAAO,CAACG,MAA9B;AACAL,IAAAA,MAAM,CAACG,KAAP,CAAaG,MAAb,GAAsBJ,OAAO,CAACK,OAAR,CAAgBC,IAAtC;AACAR,IAAAA,MAAM,CAACG,KAAP,CAAaM,EAAb,GACEP,OAAO,CAACK,OAAR,CAAgB,iBAAhB,KAAsCL,OAAO,CAACQ,UAAR,CAAmBC,aAD3D;AAED;AACF;;;;"}