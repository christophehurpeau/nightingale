{"version":3,"file":"index-browser-dev.cjs.js","sources":["../src/debug.ts","../src/index.ts"],"sourcesContent":["export default function getDebugString(): string {\n  const querystring = document.location && document.location.search;\n  const debugFromLocalStorage =\n    (window.localStorage && localStorage.getItem('debug')) || '';\n\n  if (!querystring) {\n    return debugFromLocalStorage;\n  }\n\n  // https://developer.mozilla.org/en-US/docs/Web/API/URLUtils/search#Get_the_value_of_a_single_search_param\n  const debugFromQueryString = decodeURI(\n    querystring.replace(\n      // eslint-disable-next-line unicorn/no-unsafe-regex\n      new RegExp('^(?:.*[&\\\\?]DEBUG(?:\\\\=([^&]*))?)?.*$', 'i'),\n      '$1',\n    ),\n  );\n\n  return (\n    (debugFromLocalStorage ? `${debugFromLocalStorage},` : '') +\n    debugFromQueryString\n  );\n}\n","import browserConsoleFormatter from 'nightingale-browser-console-formatter';\nimport consoleOutput from 'nightingale-console-output';\nimport createFindDebugLevel from 'nightingale-debug';\nimport type { Level, Handle, IsHandling, LogRecord } from 'nightingale-types';\nimport getDebugString from './debug';\n\n// debug string can change any time (localStorage), so we need a new object each time.\nconst findDebugLevel = (minLevel: Level, key: string): Level =>\n  createFindDebugLevel(getDebugString())(minLevel, key);\n\nconst handle: Handle = <T>(record: LogRecord<T>) => {\n  consoleOutput(browserConsoleFormatter(record), record);\n};\n\nexport default class BrowserConsoleHandler {\n  minLevel: Level = 0;\n\n  handle: Handle = handle;\n\n  isHandling: IsHandling;\n\n  constructor(minLevel: Level) {\n    this.isHandling = (level: Level, key: string) =>\n      level >= findDebugLevel(minLevel, key);\n  }\n}\n"],"names":["getDebugString","querystring","document","location","search","debugFromLocalStorage","window","localStorage","getItem","debugFromQueryString","decodeURI","replace","RegExp","findDebugLevel","minLevel","key","createFindDebugLevel","handle","record","consoleOutput","browserConsoleFormatter","BrowserConsoleHandler","isHandling","level"],"mappings":";;;;;;;;;;AAAe,SAASA,cAAT,GAAkC;AAC/C,MAAMC,WAAW,GAAGC,QAAQ,CAACC,QAAT,IAAqBD,QAAQ,CAACC,QAAT,CAAkBC,MAA3D;AACA,MAAMC,qBAAqB,GACxBC,MAAM,CAACC,YAAP,IAAuBA,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAxB,IAA0D,EAD5D;;AAGA,MAAI,CAACP,WAAL,EAAkB;AAChB,WAAOI,qBAAP;AACD,GAP8C;;;AAU/C,MAAMI,oBAAoB,GAAGC,SAAS,CACpCT,WAAW,CAACU,OAAZ;AAEE,MAAIC,MAAJ,CAAW,uCAAX,EAAoD,GAApD,CAFF,EAGE,IAHF,CADoC,CAAtC;AAQA,SACE,CAACP,qBAAqB,GAAMA,qBAAN,SAAiC,EAAvD,IACAI,oBAFF;AAID;;ACfD,IAAMI,cAAc,GAAG,SAAjBA,cAAiB,CAACC,QAAD,EAAkBC,GAAlB;AAAA,SACrBC,oBAAoB,CAAChB,cAAc,EAAf,CAApB,CAAuCc,QAAvC,EAAiDC,GAAjD,CADqB;AAAA,CAAvB;;AAGA,IAAME,MAAc,GAAG,SAAjBA,MAAiB,CAAIC,MAAJ,EAA6B;AAClDC,EAAAA,aAAa,CAACC,uBAAuB,CAACF,MAAD,CAAxB,EAAkCA,MAAlC,CAAb;AACD,CAFD;;IAIqBG,wBAOnB,+BAAYP,QAAZ,EAA6B;AAAA,OAN7BA,QAM6B,GANX,CAMW;AAAA,OAJ7BG,MAI6B,GAJZA,MAIY;;AAC3B,OAAKK,UAAL,GAAkB,UAACC,KAAD,EAAeR,GAAf;AAAA,WAChBQ,KAAK,IAAIV,cAAc,CAACC,QAAD,EAAWC,GAAX,CADP;AAAA,GAAlB;AAED;;;;"}