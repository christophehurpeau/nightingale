{"version":3,"file":"index-node4.cjs.js","sources":["../src/levelToStyles.ts","../src/levelToSymbol.ts","../src/styleToHexColor.ts","../src/styleToHtmlStyle.ts","../src/formatObject.ts","../src/formatRecordToString.ts"],"sourcesContent":["import Level from 'nightingale-levels';\n\nexport interface LevelToStyles {\n  readonly [level: number]: Array<string>;\n}\n\nconst levelToStyles: LevelToStyles = {\n  [Level.TRACE]: ['gray'],\n  [Level.DEBUG]: ['gray'],\n  // [Levels.INFO]: ['gray'],\n  [Level.WARN]: ['yellow'],\n  [Level.ERROR]: ['red', 'bold'],\n  [Level.CRITICAL]: ['red', 'bold'],\n  [Level.FATAL]: ['bgRed', 'white'],\n  [Level.EMERGENCY]: ['bgRed', 'white'],\n};\n\nexport default levelToStyles;\n","import Level from 'nightingale-levels';\n\nexport interface LevelToSymbol {\n  readonly [level: number]: string;\n}\n\nconst levelToSymbol: LevelToSymbol = {\n  [Level.TRACE]: '•',\n  [Level.DEBUG]: '•',\n  [Level.INFO]: '→',\n  [Level.WARN]: '⚠',\n  [Level.ERROR]: '✖',\n  [Level.CRITICAL]: '!',\n  [Level.FATAL]: '‼',\n  [Level.EMERGENCY]: '‼',\n};\n\nexport default levelToSymbol;\n","export interface StyleToHexColor {\n  readonly [key: string]: string;\n}\n\nconst styleToHexColor: StyleToHexColor = {\n  orange: 'ff5f00',\n  grayLight: '808080',\n  'gray-light': '808080',\n};\n\nexport default styleToHexColor;\n","/* eslint-disable no-restricted-globals */\n\nimport hexColors from './styleToHexColor';\n\nexport interface HtmlStyle {\n  readonly open: string;\n  readonly close: string;\n}\n\nexport interface StyleToHtmlStyle {\n  readonly [key: string]: HtmlStyle;\n}\n\nconst styleToHtmlStyle: StyleToHtmlStyle = {\n  // text style\n  bold: { open: 'font-weight: bold', close: 'font-weight: normal' },\n  italic: { open: 'font-style: italic', close: 'font-style: normal' },\n  underline: { open: 'text-decoration: underline', close: 'text-decoration: none' },\n  inverse: {\n    open: 'unicode-bidi: bidi-override; direction: rtl',\n    close: 'unicode-bidi: normal; direction: ltr',\n  },\n  strikethrough: { open: 'text-decoration: line-through', close: 'text-decoration: none' },\n\n  black: { open: 'color: black', close: 'color: initial' },\n  red: { open: 'color: #ff0020', close: 'color: initial' },\n  green: { open: 'color: #00b317', close: 'color: initial' },\n  yellow: { open: 'color: #ffcc00', close: 'color: initial' },\n  blue: { open: 'color: #00a0ff', close: 'color: initial' },\n  magenta: { open: 'color: #ff00a0', close: 'color: initial' },\n  cyan: { open: 'color: #00cfd8', close: 'color: initial' },\n  white: { open: 'color: white', close: 'color: initial' },\n  gray: { open: 'color: gray', close: 'color: initial' },\n\n  bgBlack: { open: 'background: black', close: 'background: initial' },\n  bgRed: { open: 'background: #ff0020', close: 'background: initial' },\n  bgGreen: { open: 'background: #00b317', close: 'background: initial' },\n  bgYellow: { open: 'background: #ffcc00', close: 'background: initial' },\n  bgBlue: { open: 'background: #00a0ff', close: 'background: initial' },\n  bgMagenta: { open: 'background: #ff00a0', close: 'background: initial' },\n  bgCyan: { open: 'background: #00cfd8', close: 'background: initial' },\n  bgWhite: { open: 'background: white', close: 'background: initial' },\n\n  orange: { open: `color: #${hexColors.orange}`, close: 'color: initial' },\n  grayLight: { open: `color: #${hexColors.grayLight}`, close: 'color: initial' },\n  'gray-light': { open: `color: #${hexColors.grayLight}`, close: 'color: initial' },\n};\n\nexport default styleToHtmlStyle;\n","/* eslint-disable max-lines, no-useless-concat, prefer-template, no-use-before-define, typescript/no-use-before-define */\nimport { Styles } from 'nightingale-types';\n\nexport { Styles };\n\nexport interface FormatObjectOptions {\n  padding?: string;\n  maxDepth?: number;\n}\n\nexport type StyleFn = (styles: Styles, value: string) => string;\nexport type ObjectStyles = { [key: string]: Styles };\n\nconst noStyleFn: StyleFn = (styles: Styles, value: string): string => value;\n\ninterface InternalFormatParams {\n  padding: string;\n  depth: number;\n  maxDepth: number;\n  objects: Set<any>;\n}\n\ninterface FormattedKey {\n  stringKey: string;\n  formattedKey: string;\n}\n\ntype FormatKey = (\n  key: string,\n  styleFn: StyleFn,\n  internalFormatParams: InternalFormatParams,\n) => FormattedKey;\n\ninterface Value {\n  key: any;\n  value: any;\n}\n\ninterface FormattedValue {\n  stringValue: string;\n  formattedValue: string;\n}\n\ntype Values = Array<Value>;\n\ninterface InternalFormatIteratorParams {\n  prefix: string;\n  suffix: string;\n  prefixSuffixSpace?: string;\n  formatKey?: FormatKey;\n}\n\nfunction tryStringify(arg: any) {\n  try {\n    return JSON.stringify(arg).replace(/\\\\n/g, '\\n');\n  } catch (_) {\n    return '[Circular]';\n  }\n}\n\nconst sameRawFormattedValue = (value: string) => ({ stringValue: value, formattedValue: value });\n\nfunction internalFormatValue(\n  value: any,\n  styleFn: StyleFn,\n  styles: Styles,\n  { padding, depth, maxDepth, objects }: InternalFormatParams,\n) {\n  const typeofValue = typeof value;\n\n  if (!styles) {\n    if (value == null) {\n      styles = ['cyan'];\n    } else {\n      switch (typeofValue) {\n        case 'boolean':\n          styles = ['green'];\n          break;\n        case 'number':\n          styles = ['yellow'];\n          break;\n        case 'string':\n          styles = ['orange'];\n          break;\n        case 'symbol':\n          styles = ['magenta'];\n          break;\n      }\n    }\n  }\n\n  let stringValue;\n  if (value === null) {\n    stringValue = 'null';\n  } else if (value === undefined) {\n    stringValue = 'undefined';\n  } else if (typeofValue === 'boolean') {\n    stringValue = value.toString();\n  } else if (value.constructor === Object) {\n    if (depth >= maxDepth) {\n      stringValue = '{Object...}';\n    } else {\n      return internalFormatObject(value, styleFn, undefined, {\n        padding,\n        depth: depth + 1,\n        maxDepth,\n        objects,\n      });\n    }\n  } else if (Array.isArray(value)) {\n    if (depth >= maxDepth) {\n      stringValue = '[Array...]';\n    } else {\n      return internalFormatArray(value, styleFn, { padding, depth: depth + 1, maxDepth, objects });\n    }\n  } else if (value instanceof Error) {\n    const stack = value.stack;\n    stringValue = stack && stack.startsWith(value.message) ? stack : `${value.message}\\n${stack}`;\n  } else if (value instanceof Map) {\n    const name = value.constructor.name;\n    if (depth >= maxDepth) {\n      stringValue = `{${name}...}`;\n    } else {\n      return internalFormatMap(name, value, styleFn, {\n        padding,\n        depth: depth + 1,\n        maxDepth,\n        objects,\n      });\n    }\n  } else if (value instanceof Set) {\n    const name = value.constructor.name;\n    if (depth >= maxDepth) {\n      stringValue = `{${name}...}`;\n    } else {\n      return internalFormatSet(name, value, styleFn, {\n        padding,\n        depth: depth + 1,\n        maxDepth,\n        objects,\n      });\n    }\n  } else if (value instanceof WeakMap) {\n    stringValue = '{WeakMap...}';\n  } else if (value instanceof WeakSet) {\n    stringValue = '{WeakSet...}';\n  } else {\n    stringValue = tryStringify(value);\n  }\n\n  const formattedValue = styleFn(styles, stringValue);\n\n  return {\n    stringValue,\n    formattedValue,\n  };\n}\n\nconst separator = ',';\n\nconst internalFormatKey: FormatKey = (\n  key: string,\n  styleFn: StyleFn,\n  internalFormatParams: InternalFormatParams,\n): FormattedKey => {\n  if (!key) return { stringKey: '', formattedKey: '' };\n  return {\n    stringKey: `${key}: `,\n    formattedKey: styleFn(['gray-light', 'bold'], `${key}:`) + ' ',\n  };\n};\n\nconst internalFormatMapKey: FormatKey = (\n  key: string,\n  styleFn: StyleFn,\n  internalFormatParams: InternalFormatParams,\n): FormattedKey => {\n  const { stringValue, formattedValue } = internalFormatValue(\n    key,\n    noStyleFn,\n    undefined,\n    internalFormatParams,\n  );\n  return {\n    stringKey: stringValue + ' => ',\n    formattedKey: styleFn(['gray-light', 'bold'], `${formattedValue}:`) + ' ',\n  };\n};\n\nconst internalFormatIterator = (\n  values: Values,\n  styleFn: StyleFn,\n  objectStyles: ObjectStyles | undefined,\n  { padding, depth, maxDepth, objects }: InternalFormatParams,\n  {\n    prefix,\n    suffix,\n    prefixSuffixSpace = ' ',\n    formatKey = internalFormatKey,\n  }: InternalFormatIteratorParams,\n) => {\n  let breakLine = false;\n  const formattedSeparator = () => styleFn(['gray'], separator);\n\n  const valuesMaxIndex = values.length - 1;\n  const formattedValues: Array<FormattedValue> = values.map(\n    ({ key, value }: { key: any; value: any }, index: number) => {\n      const nextDepth = depth + 1;\n      const internalFormatParams = { padding, depth: nextDepth, maxDepth, objects };\n\n      // key must be formatted before value (browser-formatter needs order)\n      const { stringKey, formattedKey } = formatKey(key, styleFn, internalFormatParams);\n\n      let { stringValue, formattedValue } = internalFormatValue(\n        value,\n        styleFn,\n        key && objectStyles && objectStyles[key],\n        internalFormatParams,\n      );\n\n      if (stringValue && (stringValue.length > 80 || stringValue.indexOf('\\n') !== -1)) {\n        breakLine = true;\n        stringValue = stringValue.replace(/\\n/g, `\\n${padding}`);\n        formattedValue = formattedValue.replace(/\\n/g, `\\n${padding}`);\n      }\n\n      return {\n        stringValue: stringKey + stringValue + (index === valuesMaxIndex ? '' : separator),\n        // eslint-disable-next-line no-useless-concat\n        formattedValue:\n          formattedKey + formattedValue + (index === valuesMaxIndex ? '' : formattedSeparator()),\n        // note: we need to format the separator for each values for browser-formatter\n      };\n    },\n  );\n\n  return {\n    stringValue:\n      prefix +\n      formattedValues\n        .map(breakLine ? v => `\\n${padding}${v.stringValue}` : fv => fv.stringValue)\n        .join(breakLine ? '\\n' : ' ') +\n      suffix,\n    // eslint-disable-next-line prefer-template\n    formattedValue:\n      `${prefix}${breakLine ? '' : prefixSuffixSpace}` +\n      formattedValues\n        .map(breakLine ? v => `\\n${padding}${v.formattedValue}` : v => v.formattedValue)\n        .join(breakLine ? '' : ' ') +\n      `${breakLine ? ',\\n' : prefixSuffixSpace}${suffix}`,\n  };\n};\n\nfunction internalFormatObject(\n  object: { [key: string]: any },\n  styleFn: StyleFn,\n  objectStyles: ObjectStyles | undefined,\n  { padding, depth, maxDepth, objects }: InternalFormatParams,\n) {\n  if (objects.has(object)) {\n    return sameRawFormattedValue('{Circular Object}');\n  }\n\n  const keys: Array<string> = Object.keys(object);\n  if (keys.length === 0) {\n    return sameRawFormattedValue('{}');\n  }\n\n  objects.add(object);\n\n  const result = internalFormatIterator(\n    keys.map(key => ({ key, value: object[key] })),\n    styleFn,\n    objectStyles,\n    { padding, depth, maxDepth, objects },\n    { prefix: '{', suffix: '}' },\n  );\n\n  objects.delete(object);\n\n  return result;\n}\n\nfunction internalFormatMap(\n  name: string,\n  map: Map<any, any>,\n  styleFn: StyleFn,\n  { padding, depth, maxDepth, objects }: InternalFormatParams,\n) {\n  if (objects.has(map)) {\n    return sameRawFormattedValue(`{Circular ${name}}`);\n  }\n\n  const keys = Array.from(map.keys());\n  if (keys.length === 0) {\n    return sameRawFormattedValue(`${name} {}`);\n  }\n\n  objects.add(map);\n\n  const result = internalFormatIterator(\n    keys.map(key => ({ key, value: map.get(key) })),\n    styleFn,\n    undefined,\n    { padding, depth, maxDepth, objects },\n    { prefix: `${name} {`, suffix: '}', formatKey: internalFormatMapKey },\n  );\n\n  objects.delete(map);\n\n  return result;\n}\n\nfunction internalFormatArray(\n  array: Array<any>,\n  styleFn: StyleFn,\n  { padding, depth, maxDepth, objects }: InternalFormatParams,\n) {\n  if (objects.has(array)) {\n    return sameRawFormattedValue('{Circular Array}');\n  }\n\n  if (array.length === 0) {\n    return sameRawFormattedValue('[]');\n  }\n\n  objects.add(array);\n\n  const result = internalFormatIterator(\n    array.map((value: any) => ({ key: undefined, value })),\n    styleFn,\n    undefined,\n    { padding, depth, maxDepth, objects },\n    { prefix: '[', suffix: ']', prefixSuffixSpace: '' },\n  );\n\n  objects.delete(array);\n\n  return result;\n}\n\nfunction internalFormatSet(\n  name: string,\n  set: Set<any>,\n  styleFn: StyleFn,\n  { padding, depth, maxDepth, objects }: InternalFormatParams,\n) {\n  if (objects.has(set)) {\n    return sameRawFormattedValue(`{Circular ${name}}`);\n  }\n\n  const values = Array.from(set.values());\n  if (values.length === 0) {\n    return sameRawFormattedValue(`${name} []`);\n  }\n\n  objects.add(set);\n\n  const result = internalFormatIterator(\n    values.map(value => ({ key: undefined, value })),\n    styleFn,\n    undefined,\n    { padding, depth, maxDepth, objects },\n    { prefix: `${name} [`, suffix: ']' },\n  );\n\n  objects.delete(set);\n\n  return result;\n}\n\nexport default function formatObject(\n  object: { [key: string]: any },\n  styleFn: StyleFn = noStyleFn,\n  objectStyles?: ObjectStyles,\n  { padding = '  ', maxDepth = 10 }: FormatObjectOptions = {},\n) {\n  const { formattedValue: result } = internalFormatObject(object, styleFn, objectStyles, {\n    padding,\n    maxDepth,\n    depth: 0,\n    objects: new Set(),\n  });\n\n  if (result === '{}') {\n    return '';\n  }\n\n  return result;\n}\n","import { Record } from 'nightingale-types';\nimport levelToSymbol from './levelToSymbol';\nimport levelToStyles from './levelToStyles';\nimport formatObject, { StyleFn, ObjectStyles } from './formatObject';\n\nexport default function formatRecordToString<T>(record: Record<T>, style: StyleFn) {\n  const parts: Array<string> = [];\n\n  if (record.displayName) {\n    parts.push(style(['gray-light'], record.displayName));\n  } else if (record.key) {\n    parts.push(style(['gray-light'], record.key));\n  }\n\n  if (record.datetime) {\n    parts.push(style(['gray', 'bold'], record.datetime.toTimeString().split(' ')[0]));\n    /* new Date().toFormat('HH24:MI:SS') */\n  }\n\n  let message: string = record.symbol || levelToSymbol[record.level];\n  const styles = record.styles || levelToStyles[record.level];\n\n  if (record.message) {\n    if (message) {\n      message += ` ${record.message}`;\n    } else {\n      message = record.message;\n    }\n  }\n\n  if (message) {\n    if (styles) {\n      message = style(styles, message);\n    }\n    parts.push(message);\n  }\n\n  const formatRecordObject = (\n    key: string,\n    object: Object | undefined,\n    styles: ObjectStyles | undefined,\n  ) => {\n    if (!object) {\n      return;\n    }\n\n    const stringObject = formatObject(object, style, styles);\n\n    if (!stringObject) {\n      return;\n    }\n\n    parts.push(stringObject);\n  };\n\n  formatRecordObject('metadata', record.metadata, record.metadataStyles);\n  formatRecordObject('extra', record.extra, undefined);\n  formatRecordObject('context', record.context, undefined);\n\n  return parts.join(' ');\n}\n"],"names":["levelToStyles","Level","TRACE","DEBUG","WARN","ERROR","CRITICAL","FATAL","EMERGENCY","levelToSymbol","INFO","styleToHexColor","styleToHtmlStyle","hexColors","orange","grayLight","noStyleFn","styles","value","tryStringify","arg","JSON","stringify","replace","_","sameRawFormattedValue","internalFormatValue","styleFn","padding","depth","maxDepth","objects","typeofValue","stringValue","undefined","toString","constructor","Object","internalFormatObject","Array","isArray","internalFormatArray","Error","stack","startsWith","message","Map","name","internalFormatMap","Set","internalFormatSet","WeakMap","WeakSet","formattedValue","internalFormatKey","key","internalFormatMapKey","internalFormatParams","internalFormatIterator","values","objectStyles","prefix","suffix","prefixSuffixSpace","formatKey","breakLine","formattedSeparator","valuesMaxIndex","length","formattedValues","map","index","stringKey","formattedKey","indexOf","v","fv","join","object","has","keys","add","result","delete","from","get","array","set","formatObject","formatRecordToString","record","style","parts","displayName","push","datetime","toTimeString","split","symbol","level","formatRecordObject","stringObject","metadata","metadataStyles","extra","context"],"mappings":";;;;;;;;;AAMA,IAAMA,gBAA+B;GAClCC,MAAMC,KAAP,GAAe,CAAC,MAAD,CADoB;GAElCD,MAAME,KAAP,GAAe,CAAC,MAAD,CAFoB;;GAIlCF,MAAMG,IAAP,GAAc,CAAC,QAAD,CAJqB;GAKlCH,MAAMI,KAAP,GAAe,CAAC,KAAD,EAAQ,MAAR,CALoB;GAMlCJ,MAAMK,QAAP,GAAkB,CAAC,KAAD,EAAQ,MAAR,CANiB;GAOlCL,MAAMM,KAAP,GAAe,CAAC,OAAD,EAAU,OAAV,CAPoB;GAQlCN,MAAMO,SAAP,GAAmB,CAAC,OAAD,EAAU,OAAV;CARrB;;ACAA,IAAMC,gBAA+B;GAClCR,MAAMC,KAAP,GAAe,GADoB;GAElCD,MAAME,KAAP,GAAe,GAFoB;GAGlCF,MAAMS,IAAP,GAAc,GAHqB;GAIlCT,MAAMG,IAAP,GAAc,GAJqB;GAKlCH,MAAMI,KAAP,GAAe,GALoB;GAMlCJ,MAAMK,QAAP,GAAkB,GANiB;GAOlCL,MAAMM,KAAP,GAAe,GAPoB;GAQlCN,MAAMO,SAAP,GAAmB;CARrB;;ACFA,IAAMG,kBAAmC;UAC/B,QAD+B;aAE5B,QAF4B;gBAGzB;CAHhB;;ACJA;AAEA,AAWA,IAAMC,mBAAqC;;QAEnC;UAAQ,mBAAR;WAAoC;GAFD;UAGjC;UAAQ,oBAAR;WAAqC;GAHJ;aAI9B;UAAQ,4BAAR;WAA6C;GAJf;WAKhC;UACD,6CADC;WAEA;GAPgC;iBAS1B;UAAQ,+BAAR;WAAgD;GATtB;SAWlC;UAAQ,cAAR;WAA+B;GAXG;OAYpC;UAAQ,gBAAR;WAAiC;GAZG;SAalC;UAAQ,gBAAR;WAAiC;GAbC;UAcjC;UAAQ,gBAAR;WAAiC;GAdA;QAenC;UAAQ,gBAAR;WAAiC;GAfE;WAgBhC;UAAQ,gBAAR;WAAiC;GAhBD;QAiBnC;UAAQ,gBAAR;WAAiC;GAjBE;SAkBlC;UAAQ,cAAR;WAA+B;GAlBG;QAmBnC;UAAQ,aAAR;WAA8B;GAnBK;WAqBhC;UAAQ,mBAAR;WAAoC;GArBJ;SAsBlC;UAAQ,qBAAR;WAAsC;GAtBJ;WAuBhC;UAAQ,qBAAR;WAAsC;GAvBN;YAwB/B;UAAQ,qBAAR;WAAsC;GAxBP;UAyBjC;UAAQ,qBAAR;WAAsC;GAzBL;aA0B9B;UAAQ,qBAAR;WAAsC;GA1BR;UA2BjC;UAAQ,qBAAR;WAAsC;GA3BL;WA4BhC;UAAQ,mBAAR;WAAoC;GA5BJ;UA8BjC;UAAS,WAAUC,gBAAUC,MAAO,EAApC;WAA8C;GA9Bb;aA+B9B;UAAS,WAAUD,gBAAUE,SAAU,EAAvC;WAAiD;GA/BnB;gBAgC3B;UAAS,WAAUF,gBAAUE,SAAU,EAAvC;WAAiD;;CAhCjE;;ACbA;AACA;AAYA,IAAMC,YAAqB,SAArBA,SAAqB,CAACC,MAAD,EAAiBC,KAAjB;SAA2CA,KAA3C;CAA3B;;AAuCA,SAASC,YAAT,CAAsBC,GAAtB,EAAgC;MAC1B;WACKC,KAAKC,SAAL,CAAeF,GAAf,EAAoBG,OAApB,CAA4B,MAA5B,EAAoC,IAApC,CAAP;GADF,CAEE,OAAOC,CAAP,EAAU;WACH,YAAP;;;;AAIJ,IAAMC,wBAAwB,SAAxBA,qBAAwB,CAACP,KAAD;SAAoB;iBAAeA,KAAf;oBAAsCA;GAA1D;CAA9B;;AAEA,SAASQ,mBAAT,CACER,KADF,EAEES,OAFF,EAGEV,MAHF,QAKE;MADEW,OACF,QADEA,OACF;MADWC,KACX,QADWA,KACX;MADkBC,QAClB,QADkBA,QAClB;MAD4BC,OAC5B,QAD4BA,OAC5B;MACMC,cAAc,OAAOd,KAA3B;;MAEI,CAACD,MAAL,EAAa;QACPC,SAAS,IAAb,EAAmB;eACR,CAAC,MAAD,CAAT;KADF,MAEO;cACGc,WAAR;aACO,SAAL;mBACW,CAAC,OAAD,CAAT;;;aAEG,QAAL;mBACW,CAAC,QAAD,CAAT;;;aAEG,QAAL;mBACW,CAAC,QAAD,CAAT;;;aAEG,QAAL;mBACW,CAAC,SAAD,CAAT;;;;;;MAMJC,WAAJ;;MACIf,UAAU,IAAd,EAAoB;kBACJ,MAAd;GADF,MAEO,IAAIA,UAAUgB,SAAd,EAAyB;kBAChB,WAAd;GADK,MAEA,IAAIF,gBAAgB,SAApB,EAA+B;kBACtBd,MAAMiB,QAAN,EAAd;GADK,MAEA,IAAIjB,MAAMkB,WAAN,KAAsBC,MAA1B,EAAkC;QACnCR,SAASC,QAAb,EAAuB;oBACP,aAAd;KADF,MAEO;aACEQ,qBAAqBpB,KAArB,EAA4BS,OAA5B,EAAqCO,SAArC,EAAgD;eAAA;eAE9CL,QAAQ,CAFsC;gBAAA;;OAAhD,CAAP;;GAJG,MAWA,IAAIU,MAAMC,OAAN,CAActB,KAAd,CAAJ,EAA0B;QAC3BW,SAASC,QAAb,EAAuB;oBACP,YAAd;KADF,MAEO;aACEW,oBAAoBvB,KAApB,EAA2BS,OAA3B,EAAoC;eAAA;eAAkBE,QAAQ,CAA1B;gBAAA;;OAApC,CAAP;;GAJG,MAMA,IAAIX,iBAAiBwB,KAArB,EAA4B;QAC3BC,QAAQzB,MAAMyB,KAApB;kBACcA,SAASA,MAAMC,UAAN,CAAiB1B,MAAM2B,OAAvB,CAAT,GAA2CF,KAA3C,GAAoD,GAAEzB,MAAM2B,OAAQ,KAAIF,KAAM,EAA5F;GAFK,MAGA,IAAIzB,iBAAiB4B,GAArB,EAA0B;QACzBC,OAAO7B,MAAMkB,WAAN,CAAkBW,IAA/B;;QACIlB,SAASC,QAAb,EAAuB;oBACN,IAAGiB,IAAK,MAAvB;KADF,MAEO;aACEC,kBAAkBD,IAAlB,EAAwB7B,KAAxB,EAA+BS,OAA/B,EAAwC;eAAA;eAEtCE,QAAQ,CAF8B;gBAAA;;OAAxC,CAAP;;GALG,MAYA,IAAIX,iBAAiB+B,GAArB,EAA0B;QACzBF,QAAO7B,MAAMkB,WAAN,CAAkBW,IAA/B;;QACIlB,SAASC,QAAb,EAAuB;oBACN,IAAGiB,KAAK,MAAvB;KADF,MAEO;aACEG,kBAAkBH,KAAlB,EAAwB7B,KAAxB,EAA+BS,OAA/B,EAAwC;eAAA;eAEtCE,QAAQ,CAF8B;gBAAA;;OAAxC,CAAP;;GALG,MAYA,IAAIX,iBAAiBiC,OAArB,EAA8B;kBACrB,cAAd;GADK,MAEA,IAAIjC,iBAAiBkC,OAArB,EAA8B;kBACrB,cAAd;GADK,MAEA;kBACSjC,aAAaD,KAAb,CAAd;;;MAGImC,iBAAiB1B,QAAQV,MAAR,EAAgBgB,WAAhB,CAAvB;SAEO;eAAA;;GAAP;;;AAQF,IAAMqB,oBAA+B,SAA/BA,iBAA+B,CACnCC,GADmC,EAEnC5B,OAFmC,EAIlB;MACb,CAAC4B,GAAL,EAAU,OAAO;eAAa,EAAb;kBAA+B;GAAtC;SACH;eACO,GAAEA,GAAI,IADb;kBAES5B,QAAQ,CAAC,YAAD,EAAe,MAAf,CAAR,EAAiC,GAAE4B,GAAI,GAAvC,IAA6C;GAF7D;CANF;;AAYA,IAAMC,uBAAkC,SAAlCA,oBAAkC,CACtCD,GADsC,EAEtC5B,OAFsC,EAGtC8B,oBAHsC,EAIrB;6BACuB/B,oBACtC6B,GADsC,EAEtCvC,SAFsC,EAGtCkB,SAHsC,EAItCuB,oBAJsC,CADvB;MACTxB,WADS,wBACTA,WADS;MACIoB,cADJ,wBACIA,cADJ;;SAOV;eACMpB,cAAc,MADpB;kBAESN,QAAQ,CAAC,YAAD,EAAe,MAAf,CAAR,EAAiC,GAAE0B,cAAe,GAAlD,IAAwD;GAFxE;CAXF;;AAiBA,IAAMK,yBAAyB,SAAzBA,sBAAyB,CAC7BC,MAD6B,EAE7BhC,OAF6B,EAG7BiC,YAH6B,gBAW1B;MAPDhC,OAOC,SAPDA,OAOC;MAPQC,KAOR,SAPQA,KAOR;MAPeC,QAOf,SAPeA,QAOf;MAPyBC,OAOzB,SAPyBA,OAOzB;MALD8B,MAKC,SALDA,MAKC;MAJDC,MAIC,SAJDA,MAIC;oCAHDC,iBAGC;MAHDA,iBAGC,sCAHmB,GAGnB;8BAFDC,SAEC;MAFDA,SAEC,gCAFWV,iBAEX;MACCW,YAAY,KAAhB;;MACMC,qBAAqB,SAArBA,kBAAqB;WAAMvC,QAAQ,CAAC,MAAD,CAAR,MAAN;GAA3B;;MAEMwC,iBAAiBR,OAAOS,MAAP,GAAgB,CAAvC;MACMC,kBAAyCV,OAAOW,GAAP,CAC7C,iBAA2CC,KAA3C,EAA6D;QAA1DhB,GAA0D,SAA1DA,GAA0D;QAArDrC,KAAqD,SAArDA,KAAqD;QAErDuC,uBAAuB;aAAA;aADX5B,QAAQ,CACG;cAAA;;KAA7B,CAF2D;;qBAKvBmC,UAAUT,GAAV,EAAe5B,OAAf,EAAwB8B,oBAAxB,CALuB;QAKnDe,SALmD,cAKnDA,SALmD;QAKxCC,YALwC,cAKxCA,YALwC;;gCAOrB/C,oBACpCR,KADoC,EAEpCS,OAFoC,EAGpC4B,OAAOK,YAAP,IAAuBA,aAAaL,GAAb,CAHa,EAIpCE,oBAJoC,CAPqB;QAOrDxB,WAPqD,yBAOrDA,WAPqD;QAOxCoB,cAPwC,yBAOxCA,cAPwC;;QAcvDpB,gBAAgBA,YAAYmC,MAAZ,GAAqB,EAArB,IAA2BnC,YAAYyC,OAAZ,CAAoB,IAApB,MAA8B,CAAC,CAA1E,CAAJ,EAAkF;kBACpE,IAAZ;oBACczC,YAAYV,OAAZ,CAAoB,KAApB,EAA4B,KAAIK,OAAQ,EAAxC,CAAd;uBACiByB,eAAe9B,OAAf,CAAuB,KAAvB,EAA+B,KAAIK,OAAQ,EAA3C,CAAjB;;;WAGK;mBACQ4C,YAAYvC,WAAZ,IAA2BsC,UAAUJ,cAAV,GAA2B,EAA3B,MAA3B,CADR;;sBAIHM,eAAepB,cAAf,IAAiCkB,UAAUJ,cAAV,GAA2B,EAA3B,GAAgCD,oBAAjE,CAJG;;KAAP;GArB2C,CAA/C;SA+BO;iBAEHL,SACAQ,gBACGC,GADH,CACOL,YAAY;aAAM,KAAIrC,OAAQ,GAAE+C,EAAE1C,WAAY,EAAlC;KAAZ,GAAkD;aAAM2C,GAAG3C,WAAT;KADzD,EAEG4C,IAFH,CAEQZ,YAAY,IAAZ,GAAmB,GAF3B,CADA,GAIAH,MANG;;oBASF,GAAED,MAAO,GAAEI,YAAY,EAAZ,GAAiBF,iBAAkB,EAA/C,GACAM,gBACGC,GADH,CACOL,YAAY;aAAM,KAAIrC,OAAQ,GAAE+C,EAAEtB,cAAe,EAArC;KAAZ,GAAqD;aAAKsB,EAAEtB,cAAP;KAD5D,EAEGwB,IAFH,CAEQZ,YAAY,EAAZ,GAAiB,GAFzB,CADA,GAIC,GAAEA,YAAY,KAAZ,GAAoBF,iBAAkB,GAAED,MAAO;GAbtD;CA/CF;;AAgEA,SAASxB,oBAAT,CACEwC,MADF,EAEEnD,OAFF,EAGEiC,YAHF,SAKE;MADEhC,OACF,SADEA,OACF;MADWC,KACX,SADWA,KACX;MADkBC,QAClB,SADkBA,QAClB;MAD4BC,OAC5B,SAD4BA,OAC5B;;MACIA,QAAQgD,GAAR,CAAYD,MAAZ,CAAJ,EAAyB;WAChBrD,sBAAsB,mBAAtB,CAAP;;;MAGIuD,OAAsB3C,OAAO2C,IAAP,CAAYF,MAAZ,CAA5B;;MACIE,KAAKZ,MAAL,KAAgB,CAApB,EAAuB;WACd3C,sBAAsB,IAAtB,CAAP;;;UAGMwD,GAAR,CAAYH,MAAZ;MAEMI,SAASxB,uBACbsB,KAAKV,GAAL,CAAS;WAAQ;SAAA;aAAcQ,OAAOvB,GAAP;KAAtB;GAAT,CADa,EAEb5B,OAFa,EAGbiC,YAHa,EAIb;WAAA;SAAA;YAAA;;GAJa,EAKb;YAAU,GAAV;YAAuB;GALV,CAAf;UAQQuB,MAAR,CAAeL,MAAf;SAEOI,MAAP;;;AAGF,SAASlC,iBAAT,CACED,IADF,EAEEuB,GAFF,EAGE3C,OAHF,SAKE;MADEC,OACF,SADEA,OACF;MADWC,KACX,SADWA,KACX;MADkBC,QAClB,SADkBA,QAClB;MAD4BC,OAC5B,SAD4BA,OAC5B;;MACIA,QAAQgD,GAAR,CAAYT,GAAZ,CAAJ,EAAsB;WACb7C,sBAAuB,aAAYsB,IAAK,GAAxC,CAAP;;;MAGIiC,OAAOzC,MAAM6C,IAAN,CAAWd,IAAIU,IAAJ,EAAX,CAAb;;MACIA,KAAKZ,MAAL,KAAgB,CAApB,EAAuB;WACd3C,sBAAuB,GAAEsB,IAAK,KAA9B,CAAP;;;UAGMkC,GAAR,CAAYX,GAAZ;MAEMY,SAASxB,uBACbsB,KAAKV,GAAL,CAAS;WAAQ;SAAA;aAAcA,IAAIe,GAAJ,CAAQ9B,GAAR;KAAtB;GAAT,CADa,EAEb5B,OAFa,EAGbO,SAHa,EAIb;WAAA;SAAA;YAAA;;GAJa,EAKb;YAAW,GAAEa,IAAK,IAAlB;YAA+B,GAA/B;eAA+CS;GALlC,CAAf;UAQQ2B,MAAR,CAAeb,GAAf;SAEOY,MAAP;;;AAGF,SAASzC,mBAAT,CACE6C,KADF,EAEE3D,OAFF,SAIE;MADEC,OACF,SADEA,OACF;MADWC,KACX,SADWA,KACX;MADkBC,QAClB,SADkBA,QAClB;MAD4BC,OAC5B,SAD4BA,OAC5B;;MACIA,QAAQgD,GAAR,CAAYO,KAAZ,CAAJ,EAAwB;WACf7D,sBAAsB,kBAAtB,CAAP;;;MAGE6D,MAAMlB,MAAN,KAAiB,CAArB,EAAwB;WACf3C,sBAAsB,IAAtB,CAAP;;;UAGMwD,GAAR,CAAYK,KAAZ;MAEMJ,SAASxB,uBACb4B,MAAMhB,GAAN,CAAU,UAACpD,KAAD;WAAiB;WAAOgB,SAAP;;KAAjB;GAAV,CADa,EAEbP,OAFa,EAGbO,SAHa,EAIb;WAAA;SAAA;YAAA;;GAJa,EAKb;YAAU,GAAV;YAAuB,GAAvB;uBAA+C;GALlC,CAAf;UAQQiD,MAAR,CAAeG,KAAf;SAEOJ,MAAP;;;AAGF,SAAShC,iBAAT,CACEH,IADF,EAEEwC,GAFF,EAGE5D,OAHF,SAKE;MADEC,OACF,SADEA,OACF;MADWC,KACX,SADWA,KACX;MADkBC,QAClB,SADkBA,QAClB;MAD4BC,OAC5B,SAD4BA,OAC5B;;MACIA,QAAQgD,GAAR,CAAYQ,GAAZ,CAAJ,EAAsB;WACb9D,sBAAuB,aAAYsB,IAAK,GAAxC,CAAP;;;MAGIY,SAASpB,MAAM6C,IAAN,CAAWG,IAAI5B,MAAJ,EAAX,CAAf;;MACIA,OAAOS,MAAP,KAAkB,CAAtB,EAAyB;WAChB3C,sBAAuB,GAAEsB,IAAK,KAA9B,CAAP;;;UAGMkC,GAAR,CAAYM,GAAZ;MAEML,SAASxB,uBACbC,OAAOW,GAAP,CAAW;WAAU;WAAOpC,SAAP;;KAAV;GAAX,CADa,EAEbP,OAFa,EAGbO,SAHa,EAIb;WAAA;SAAA;YAAA;;GAJa,EAKb;YAAW,GAAEa,IAAK,IAAlB;YAA+B;GALlB,CAAf;UAQQoC,MAAR,CAAeI,GAAf;SAEOL,MAAP;;;AAGF,AAAe,SAASM,YAAT,CACbV,MADa,EAEbnD,OAFa,EAGbiC,YAHa,SAKb;MAHAjC,OAGA;WAAA,GAHmBX,SAGnB;;;iCADyD,EACzD;4BADEY,OACF;MADEA,OACF,8BADY,IACZ;6BADkBE,QAClB;MADkBA,QAClB,+BAD6B,EAC7B;;8BACmCQ,qBAAqBwC,MAArB,EAA6BnD,OAA7B,EAAsCiC,YAAtC,EAAoD;WAAA;YAAA;WAG9E,CAH8E;aAI5E,IAAIX,GAAJ;GAJwB,CADnC;MACwBiC,MADxB,yBACQ7B,cADR;;MAQI6B,WAAW,IAAf,EAAqB;WACZ,EAAP;;;SAGKA,MAAP;;;AC/Xa,SAASO,oBAAT,CAAiCC,MAAjC,EAAoDC,KAApD,EAAoE;MAC3EC,QAAuB,EAA7B;;MAEIF,OAAOG,WAAX,EAAwB;UAChBC,IAAN,CAAWH,MAAM,CAAC,YAAD,CAAN,EAAsBD,OAAOG,WAA7B,CAAX;GADF,MAEO,IAAIH,OAAOnC,GAAX,EAAgB;UACfuC,IAAN,CAAWH,MAAM,CAAC,YAAD,CAAN,EAAsBD,OAAOnC,GAA7B,CAAX;;;MAGEmC,OAAOK,QAAX,EAAqB;UACbD,IAAN,CAAWH,MAAM,CAAC,MAAD,EAAS,MAAT,CAAN,EAAwBD,OAAOK,QAAP,CAAgBC,YAAhB,GAA+BC,KAA/B,CAAqC,GAArC,EAA0C,CAA1C,CAAxB,CAAX;;;;MAIEpD,UAAkB6C,OAAOQ,MAAP,IAAiBzF,cAAciF,OAAOS,KAArB,CAAvC;MACMlF,SAASyE,OAAOzE,MAAP,IAAiBjB,cAAc0F,OAAOS,KAArB,CAAhC;;MAEIT,OAAO7C,OAAX,EAAoB;QACdA,OAAJ,EAAa;iBACC,IAAG6C,OAAO7C,OAAQ,EAA9B;KADF,MAEO;gBACK6C,OAAO7C,OAAjB;;;;MAIAA,OAAJ,EAAa;QACP5B,MAAJ,EAAY;gBACA0E,MAAM1E,MAAN,EAAc4B,OAAd,CAAV;;;UAEIiD,IAAN,CAAWjD,OAAX;;;MAGIuD,qBAAqB,SAArBA,kBAAqB,CACzB7C,GADyB,EAEzBuB,MAFyB,EAGzB7D,MAHyB,EAItB;QACC,CAAC6D,MAAL,EAAa;;;;QAIPuB,eAAeb,aAAaV,MAAb,EAAqBa,KAArB,EAA4B1E,MAA5B,CAArB;;QAEI,CAACoF,YAAL,EAAmB;;;;UAIbP,IAAN,CAAWO,YAAX;GAfF;;qBAkBmB,UAAnB,EAA+BX,OAAOY,QAAtC,EAAgDZ,OAAOa,cAAvD;qBACmB,OAAnB,EAA4Bb,OAAOc,KAAnC,EAA0CtE,SAA1C;qBACmB,SAAnB,EAA8BwD,OAAOe,OAArC,EAA8CvE,SAA9C;SAEO0D,MAAMf,IAAN,CAAW,GAAX,CAAP;;;;;;;;;;"}